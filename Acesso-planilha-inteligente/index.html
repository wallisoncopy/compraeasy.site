<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Planilha Inteligente de Produtos - Supermercado</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Tela de Login -->
  <div id="loginScreen" class="login-container">
    <div class="login-card">
      <div class="login-header">
        <div class="login-icon">ğŸª</div>
        <h1>Planilha Inteligente</h1>
        <p>Sistema de GestÃ£o de Produtos</p>
      </div>
      <form id="loginForm" class="login-form">
        <div class="form-group">
          <label for="supermarketName">Nome do Supermercado Mercearia ou Padaria</label>
          <input type="text" id="supermarketName" placeholder="Ex: Supermercado SÃ£o JosÃ©" required>
        </div>
        <div class="form-group">
          <label for="password">Senha</label>
          <input type="password" id="password" placeholder="Digite qualquer senha">
        </div>
        <div class="form-group">
          <label for="colorTheme">Cor do Sistema</label>
          <select id="colorTheme" class="color-select">
            <option value="theme-pao-de-acucar">ğŸ”´ Vermelho</option>
            <option value="theme-extra">ğŸ”µ Azul</option>
            <option value="theme-carrefour">ğŸŸ  Laranja</option>
            <option value="theme-big">ğŸŸ£ Roxo</option>
            <option value="theme-atacadao">ğŸŸ¢ Verde</option>
            <option value="theme-default">âš« PadrÃ£o</option>
          </select>
        </div>
        <button type="submit" class="login-btn" id="loginBtn">
          <span class="btn-text">ğŸ›’ Acessar Sistema</span>
          <div class="loading-spinner" style="display: none;"></div>
        </button>
      </form>
      <div class="login-tip">
        ğŸ’¡ Dica: Use qualquer senha para acessar o sistema
      </div>
    </div>
  </div>

  <!-- Sistema Principal -->
  <div id="mainSystem" class="main-container" style="display: none;">
    <!-- Header -->
    <header class="main-header">
      <div class="header-content">
        <div class="header-left">
          <div class="header-icon">ğŸ“ˆ</div>
          <div class="header-info">
            <h1 id="systemTitle">Planilha Inteligente de Produtos</h1>
            <p>PerÃ­odo padrÃ£o: <strong>Mensal (30 dias)</strong></p>
            <small>Ajuste consumo mÃ©dio e lead time para cÃ¡lculo do ponto de reposiÃ§Ã£o.</small>
          </div>
        </div>
        <button class="logout-btn" id="logoutBtn">ğŸšª Sair</button>
      </div>
    </header>

    <div class="wrap">
      <!-- Busca e Filtros -->
      <div class="search-filters">
        <div class="search-box">
          <input type="text" id="searchProducts" placeholder="ğŸ” Buscar produto..." data-testid="input-search">
        </div>
        <div class="filter-box">
          <select id="filterCategory" data-testid="select-category">
            <option value="">ğŸ“‚ Todas as categorias</option>
            <option value="Mercearia">ğŸŒ¾ Mercearia</option>
            <option value="AÃ§ougue">ğŸ¥© AÃ§ougue</option>
            <option value="Padaria">ğŸ Padaria</option>
            <option value="Frios">ğŸ§€ Frios</option>
            <option value="Limpeza">ğŸ§½ Limpeza</option>
            <option value="Higiene">ğŸ§¼ Higiene</option>
            <option value="HortifrÃºti">ğŸ¥¬ HortifrÃºti</option>
            <option value="Bebidas">ğŸ¥¤ Bebidas</option>
          </select>
        </div>
        <div class="sort-box">
          <select id="sortProducts" data-testid="select-sort">
            <option value="">ğŸ“‹ Ordenar por...</option>
            <option value="name">ğŸ“ Nome A-Z</option>
            <option value="category">ğŸ“‚ Categoria</option>
            <option value="profit">ğŸ’° Maior Lucro</option>
            <option value="stock">ğŸ“¦ Menor Estoque</option>
            <option value="consumption">ğŸ“ˆ Mais Vendido</option>
          </select>
        </div>
        <button class="btn filter-btn" onclick="limparFiltros()" data-testid="button-clear-filters">ğŸ—‘ï¸ Limpar</button>
      </div>

      <!-- Controles -->
      <div class="controls">
        <button class="btn" onclick="adicionarLinha()">â• Produto</button>
        <button class="btn warning" onclick="gerarListaCompras()">ğŸ›’ Lista de Compras</button>
        <button class="btn" onclick="salvarDados()">ğŸ’¾ Salvar Lista</button>
        <button class="btn" onclick="carregarDados()">ğŸ“‚ Carregar Lista</button>
        <button class="btn" onclick="exportarCSV()">â¬‡ Exportar CSV</button>
        <button class="btn secondary" onclick="calcular()">ğŸ“Š Recalcular</button>
        <button class="btn danger" onclick="resetarTudo()">ğŸ”„ Reset Completo</button>
      </div>

      <!-- Tabela de Produtos -->
      <div class="table-container">
        <table id="tabela">
          <thead>
            <tr>
              <th>Produto</th>
              <th>Categoria</th>
              <th>Consumo MÃ©dio / MÃªs</th>
              <th>Estoque Atual</th>
              <th>PreÃ§o Compra (R$)</th>
              <th>PreÃ§o Venda (R$)</th>
              <th>Lead Time (dias)</th>
              <th>Qtd. Sugerida</th>
              <th>Ponto ReposiÃ§Ã£o</th>
              <th>Lucro Pot. / MÃªs (R$)</th>
              <th>AÃ§Ã£o</th>
            </tr>
          </thead>
          <tbody>
            <!-- Produtos prÃ©-preenchidos serÃ£o inseridos aqui pelo JavaScript -->
          </tbody>
        </table>
      </div>

      <!-- Resumo -->
      <div class="summary">
        <div class="card">
          <div class="card-title">âš ï¸ Produtos em risco de falta</div>
          <div id="riscoList" class="risk-content">Nenhum</div>
        </div>
        <div class="card">
          <div class="card-title">ğŸ’° Total Estimado de Compra (R$)</div>
          <div id="totalCompra" class="total-value">R$ 0,00</div>
        </div>
        <div class="card">
          <div class="card-title">ğŸ“ˆ Lucro Potencial Mensal (R$)</div>
          <div id="totalLucro" class="profit-value">R$ 0,00</div>
        </div>
      </div>

      <!-- GrÃ¡fico -->
      <div class="chart-container">
        <canvas id="chartConsumo" height="120"></canvas>
      </div>

      <!-- RodapÃ© -->
      <footer class="main-footer">
        ğŸ’¡ <strong>Dica:</strong> preencha o <strong>Consumo MÃ©dio / MÃªs</strong> com mÃ©dia de vendas reais.<br>
        Lead Time = dias que o fornecedor demora para entregar (use 7 se nÃ£o souber).
      </footer>
    </div>
  </div>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <!-- Base de dados de produtos -->
  <script src="data/products.js"></script>
  
  <script src="script.js"></script>
</body>
</html>