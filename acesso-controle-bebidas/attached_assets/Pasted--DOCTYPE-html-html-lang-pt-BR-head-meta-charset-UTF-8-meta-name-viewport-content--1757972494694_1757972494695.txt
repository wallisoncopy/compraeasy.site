<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Planilha Anti-Falta de Bebidas</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background:#f4f7fb; margin:0; padding:20px; }
    h1 { text-align:center; color:#2c3e50; }
    table { width:100%; border-collapse:collapse; margin-top:20px; }
    th, td { border:1px solid #ccc; padding:8px; text-align:center; }
    th { background:#3498db; color:white; }
    button { margin:10px 5px; padding:10px 15px; border:none; border-radius:6px; cursor:pointer; }
    .btn-add { background:#27ae60; color:white; }
    .btn-save { background:#f39c12; color:white; }
    .btn-load { background:#2980b9; color:white; }
    .alerta { color:red; font-weight:bold; }
  </style>
</head>
<body>
  <h1>ðŸ¥¤ Planilha Anti-Falta de Bebidas</h1>
  <p style="text-align:center;">Nunca mais perca clientes porque a cerveja ou o refrigerante acabaram!</p>

  <button class="btn-add" onclick="adicionarLinha()">+ Adicionar Bebida</button>
  <button class="btn-save" onclick="salvarDados()">ðŸ’¾ Salvar Lista</button>
  <button class="btn-load" onclick="carregarDados()">ðŸ“‚ Carregar Lista</button>

  <table id="tabela">
    <thead>
      <tr>
        <th>Bebida</th>
        <th>Marca</th>
        <th>Estoque Atual</th>
        <th>Consumo MÃ©dio / Semana</th>
        <th>Estoque MÃ­nimo</th>
        <th>SugestÃ£o de Compra</th>
        <th>Alerta</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <canvas id="graficoBebidas" width="400" height="200"></canvas>

  <script>
    function adicionarLinha(nome="",marca="",estoque=0,consumo=0,minimo=0){
      const tabela=document.querySelector("#tabela tbody");
      const linha=document.createElement("tr");
      linha.innerHTML=`
        <td><input type="text" value="${nome}" placeholder="Ex: Cerveja"></td>
        <td><input type="text" value="${marca}" placeholder="Ex: Skol"></td>
        <td><input type="number" value="${estoque}"></td>
        <td><input type="number" value="${consumo}"></td>
        <td><input type="number" value="${minimo}"></td>
        <td class="sugestao">0</td>
        <td class="alerta"></td>
      `;
      tabela.appendChild(linha);
      atualizar();
    }

    function atualizar(){
      const linhas=document.querySelectorAll("#tabela tbody tr");
      let dados=[];
      linhas.forEach(linha=>{
        const bebida=linha.cells[0].querySelector("input").value;
        const marca=linha.cells[1].querySelector("input").value;
        const estoque=parseInt(linha.cells[2].querySelector("input").value)||0;
        const consumo=parseInt(linha.cells[3].querySelector("input").value)||0;
        const minimo=parseInt(linha.cells[4].querySelector("input").value)||0;

        let sugestao=0;
        let alerta="";
        if(estoque < minimo){
          sugestao=(consumo+minimo)-estoque;
          alerta="âš  Precisa repor!";
        }

        linha.querySelector(".sugestao").innerText=sugestao;
        linha.querySelector(".alerta").innerText=alerta;

        dados.push({bebida,marca,estoque,consumo,minimo,sugestao});
      });
      desenharGrafico(dados);
    }

    function salvarDados(){
      const linhas=document.querySelectorAll("#tabela tbody tr");
      let dados=[];
      linhas.forEach(linha=>{
        dados.push({
          bebida:linha.cells[0].querySelector("input").value,
          marca:linha.cells[1].querySelector("input").value,
          estoque:linha.cells[2].querySelector("input").value,
          consumo:linha.cells[3].querySelector("input").value,
          minimo:linha.cells[4].querySelector("input").value
        });
      });
      localStorage.setItem("planilha_bebidas",JSON.stringify(dados));
      alert("âœ… Lista de bebidas salva no navegador!");
    }

    function carregarDados(){
      const dados=JSON.parse(localStorage.getItem("planilha_bebidas")||"[]");
      const tabela=document.querySelector("#tabela tbody");
      tabela.innerHTML="";
      dados.forEach(item=>{
        adicionarLinha(item.bebida,item.marca,item.estoque,item.consumo,item.minimo);
      });
      atualizar();
    }

    let chart=null;
    function desenharGrafico(dados){
      const ctx=document.getElementById("graficoBebidas").getContext("2d");
      if(chart) chart.destroy();
      chart=new Chart(ctx,{
        type:"bar",
        data:{
          labels:dados.map(d=>d.bebida+" "+d.marca),
          datasets:[{
            label:"Estoque Atual",
            data:dados.map(d=>d.estoque),
            backgroundColor:"#3498db"
          },{
            label:"Consumo MÃ©dio/semana",
            data:dados.map(d=>d.consumo),
            backgroundColor:"#2ecc71"
          }]
        },
        options:{responsive:true,scales:{y:{beginAtZero:true}}}
      });
    }

    document.addEventListener("input",atualizar);
  </script>
</body>
</html>
